## 跳跃表
好的博客文章，就像一篇篇动人的故事一样，我喜欢那样的故事。我总是不太讲故事，主要还是因为不会讲。也许正因如此，我想讲一次能让自己喜欢的故事。哈哈。。。

### 我和跳跃表(skiplist)的故事
2010年冬季的一天，自学完链表之后。当时就有想过，如果把指针域改成数组的形式会怎样？可又想，数据域就一个整型值，指针域那么大，不是太浪费了吗[当时的想法就这么简单，以至于阉割了自己更早接触到跳表的可能]？至此，这个想法也就终止了。几年后，在算法与数据结构那本书中第一次接触到跳表时，不禁有些遗憾。下面，首先简单看一下单链表，这里用C语言的结构体表示，如下。如果每一个节点用指针连起来，结构上如下面的图所示。
    
    struct LinkedListNode
    {
        T data;
        struct LinkedListNode* next;
    };

![](https://github.com/WalkingNL/Pics/blob/master/List1.jpg)

以上就是单链表，跳表与它相差就在于指针域是一个数组，用C语言结构体表示如下。这么一个看似在单链表上的小小的变化，带来的应用潜力无疑是巨大的。同样，把跳表的每一个节点连起来，如下图所示。

    struct LinkedListNode
    {
        T data;
        struct LinkedListNode* next[NUMLAYER]; // NUMLAYER表示指针的个数
    };
![](https://github.com/WalkingNL/Pics/blob/master/SkipList1.jpg)

当然了，按照跳表的定义，以上还不能称跳表，但是它已经具备跳表的**形**。在忽略空间因素的情况下，单纯从上面两个图的观感上，很明显跳表要复杂一些，但同时也带来了查询、插入等操作效率上的提高。嗯，就一些吗？想想看，如果有些节点的指针域再增加一些，会怎样？在真正进入正题之前，用几句话谈谈感想。
1. 第一次认识链表后，隔了至少5年，我才真正接触到跳表这种结构。更为遗憾的是，带我认识跳表的那本经典的数据结构书，一直在我的卧榻之侧。
2. 刚接触链表之后，就想到过指针域变成数组，却最终变成了一个浅尝辄止的想法。事后许多事情证明这是莫大的缺失。

#### 跳跃表
就[SkipList](https://www.csee.umbc.edu/courses/undergraduate/341/fall01/Lectures/SkipLists/skip_lists/skip_lists.html)的结构而言，本质上他依然属于线性的数据结构，这一点和普通链表无差。跳跃表的出现，大大提升了线性链式结构的查询、插入、删除等操作的效率。那么，具体是如何做到的呢？接下来我们用两个小结的篇幅分析一下。
#### 跳跃表的查询及插入分析
对比上面的图，这里作稍微的调整，让链表与跳跃表中的节点按值从小到大排列，如下。

对于`查询`操作。如果要查询值为37的节点，就需要对比5个节点。而对于`插入`操作，假如要在值为37的节点之后，插入一个值为41的节点。先要确定好插入的位置，然后才能执行插入操作。而确定好插入的位置，需要对比6个节点，然后再插入。

![](https://github.com/WalkingNL/Pics/blob/master/list2.jpg)

如果是跳表，对于`查询`操作，同样如果查询值为37的节点，只需要对比3个节点的值；对于`插入`操作，要在37的节点之后，插入值为41的节点，也只需要对比4个节点，就能确定好插入位置。

![](https://github.com/WalkingNL/Pics/blob/master/SkipList2.jpg)

以上简单的描述中，能够看出，对于单链表而言，查询数据的时间复杂度是O(n)。虽然插入操作本身时间复杂度是O(1)，但是插入数据前先要确定好插入位置，这就相当于先要做查询操作，而查询操作的时间复杂度是O(1)。

我们知道，对于元素值有序的数组结构，采用二分查找，能够让查询操作的时间复杂度提升到O(logn)。但是对链表而言，由于节点分布的位置是离散的，无法采用二分查找的思想。但是通过**合理的配置**每一个节点指针域的个数，就像跳跃表这样，能够达到相似的效果。上面的例子中，如果查询37的节点，单链表中需要对比5个节点，而跳表只需要对比3个。因为里面都包含了目标节点(值为37的节点)，如果各自去掉这个节点，可以发现，前者对比的节点数正好是后者的两倍。如果在上面跳跃表的基础上，对某些节点再增加一层指针域，如下图。分别在第一个节点以及第5个节点上，增加了一层指针域。这样一来，如果查询37的节点，除去目标节点外，只需要对比一个节点。

![](https://github.com/WalkingNL/Pics/blob/master/SkipList4.jpg)


#### 跳跃表的性能分析

#### Redis中的跳跃表

####
